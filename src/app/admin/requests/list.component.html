<h1>Requests</h1>

<!-- Create Button -->
<p>
  <a routerLink="add" class="btn btn-sm btn-primary mb-2 shadow-sm">
    + Create Request
  </a>
</p>

<!-- Unified Requests Table -->
<table class="table table-striped table-hover align-middle">
  <thead class="table-light text-secondary">
    <tr>
      <th style="width: 15%">Type</th>
      <th style="width: 20%">Employee</th>
      <th style="width: 25%">Items</th>
      <th style="width: 15%">Status</th>
      <th style="width: 15%">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let req of requests">
      <!-- Type -->
      <td>{{ req.type || '—' }}</td>

      <!-- Employee -->
      <td>
        {{ req.employee?.employeeId || '—' }}
        <span *ngIf="req.employee?.account?.status !== 'Active'"> (Inactive)</span>
      </td>

      <!-- Items -->
      <td>{{ req.items || '—' }}</td>

      <!-- Status Badge -->
      <td>
        <span 
          class="badge"
          [ngClass]="{
            'bg-success': req.status === 'Approved',
            'bg-warning': req.status === 'Pending',
            'bg-danger': req.status === 'Rejected'
          }">
          {{ req.status }}
        </span>
      </td>

      <!-- Actions -->
      <td style="white-space: nowrap">
        <a [routerLink]="['/admin/requests/edit', req.id]" class="btn btn-sm btn-primary">
          Edit
        </a>
        <!-- Optional workflow button -->
        <!--
        <a [routerLink]="['/admin/workflows', req.employee?.employeeId]" 
          class="btn btn-sm btn-outline-secondary ms-1">
          Workflows
        </a>
        -->
      </td>
    </tr>

    <!-- Loading spinner while fetching -->
    <tr *ngIf="!requests || loading">
      <td colspan="5" class="text-center py-3">
        <span class="spinner-border spinner-border-lg align-center"></span>
      </td>
    </tr>

    <!-- No requests found -->
    <tr *ngIf="!loading && (!requests || requests.length === 0)">
      <td colspan="5" class="text-center text-muted py-3">
        No requests found
      </td>
    </tr>
  </tbody>
</table>
